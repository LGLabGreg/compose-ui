---
description: When creating a new compose-ui component
alwaysApply: false
---

## General Component Structure (Applies to All Components)

1. **File location**: `packages/compose-ui/src/components/{component-name}.tsx`
2. **Add `'use client'`** directive at the top
3. **Use `cn` utility** from `../lib/utils` for class merging
4. **Use CVA** (`class-variance-authority`) for variants when needed

## Naming & Exports (Applies to All Components)

- Prefix sub-components with parent name: `TabsRoot`, `TabsList`, `TabsTab`
- Set `displayName`: `Component.displayName = 'ComponentPart'`
- Export all ComponentPart and ComponentPartProps at the bottom of `packages/compose-ui/src/components/{component-name}.tsx`
- Export from `src/index.ts`

## Styling (Applies to All Components)

- Use Tailwind classes with design tokens (`bg-muted`, `text-foreground`, `border-border`)
- **Do not repeat** focus ring and disabled styles - these are globally applied in `styles/default.css`:
  - `focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2`
  - `data-disabled:pointer-events-none data-disabled:opacity-70`

## Base UI Components (Only When Creating Components Based on Base UI)

When creating a component that wraps Base UI (use `@cursor/commands/create-baseui-component.md`):

- **Import from Base UI**: `import { Component } from '@base-ui/react/component'`
- **Type props**: `type ComponentPartProps = React.ComponentProps<typeof BaseComponent> & {...}`
- **Use Base UI data attributes** for states: `data-[selected]:`, `data-[disabled]:`
- **Accessibility**: Base UI handles ARIA attributes, keyboard navigation, and focus management automatically. Compose-ui is responsible for:
  - **Color contrast**: Ensure sufficient contrast between foreground/background using design tokens

## Custom Components (Only When Creating Custom Components)

When creating a custom component not based on Base UI (use `@cursor/commands/create-component.md`):

- Use standard React elements (`div`, `span`, `button`, etc.) or custom implementations
- **Type props**: `type ComponentProps = React.ComponentProps<'element'> & {...}`
- **Use data attributes** for states when needed: `data-[selected]:`, `data-[disabled]:`, `data-[checked]:`
- **Accessibility**: You are responsible for:
  - ARIA attributes
  - Keyboard navigation
  - Focus management
  - **Color contrast**: Ensure sufficient contrast between foreground/background using design tokens
- Review the Badge component (`packages/compose-ui/src/components/badge.tsx`) as a reference

## Preview Page (Applies to All Components)

Create `apps/docs/app/(docs)/components/{component-name}/page.tsx` and add to sidebar in `components-sidebar.tsx`

**Note**: LLM documentation files (`apps/docs/public/llms/{component-name}.md`) are automatically generated in CI - do not create them manually.

## Testing (Applies to All Components)

Add test for the component

- **Composition**: Create and test composed component as they would be used by the library user
- **Accessibility**: Always get elements by their accessible roles
- **User first**: Test components as they would be interacted with by a real user using userEvent
- **No comments**: Do not include comments in test files - the test code should be self-explanatory

### Example

```
import { render } from '~/vitest.utils'

it('calls the onClick handler when clicked', async () => {
  const onClick = vi.fn()
  const { user } = render(<Button onClick={onClick}>Click</Button>)
  await user.click(screen.getByRole('button', { name: 'Click' }))
  expect(onClick).toHaveBeenCalled()
})
```
